import {
  Pauser,
  PseudoWeakRef,
  forAwaitOf
} from "./chunk-CBZSRIIO.js";
import {
  AsyncDirective
} from "./chunk-SU3NKPMQ.js";
import {
  directive
} from "./chunk-RMSEGTBR.js";
import {
  noChange
} from "./chunk-32RPEPIA.js";

// node_modules/lit-html/development/directives/async-replace.js
var AsyncReplaceDirective = class extends AsyncDirective {
  constructor() {
    super(...arguments);
    this.__weakThis = new PseudoWeakRef(this);
    this.__pauser = new Pauser();
  }
  // @ts-expect-error value not used, but we want a nice parameter for docs
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  render(value, _mapper) {
    return noChange;
  }
  update(_part, [value, mapper]) {
    if (!this.isConnected) {
      this.disconnected();
    }
    if (value === this.__value) {
      return noChange;
    }
    this.__value = value;
    let i = 0;
    const { __weakThis: weakThis, __pauser: pauser } = this;
    forAwaitOf(value, async (v) => {
      while (pauser.get()) {
        await pauser.get();
      }
      const _this = weakThis.deref();
      if (_this !== void 0) {
        if (_this.__value !== value) {
          return false;
        }
        if (mapper !== void 0) {
          v = mapper(v, i);
        }
        _this.commitValue(v, i);
        i++;
      }
      return true;
    });
    return noChange;
  }
  // Override point for AsyncAppend to append rather than replace
  commitValue(value, _index) {
    this.setValue(value);
  }
  disconnected() {
    this.__weakThis.disconnect();
    this.__pauser.pause();
  }
  reconnected() {
    this.__weakThis.reconnect(this);
    this.__pauser.resume();
  }
};
var asyncReplace = directive(AsyncReplaceDirective);

export {
  AsyncReplaceDirective,
  asyncReplace
};
/*! Bundled license information:

lit-html/development/directives/async-replace.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)
*/
//# sourceMappingURL=chunk-PAS3GZJU.js.map
