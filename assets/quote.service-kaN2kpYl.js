import{P as u}from"./index-DeW_3Z4T.js";import{Q as o}from"./quote.model-CvL1ADQq.js";let r=[{id:1,quoteNumber:"QT-2024-001",type:"standard",companyId:1,companyName:"Acme Corporation",contactName:"John Smith",contactEmail:"john.smith@acme.com",contactPhone:"+1-555-0100",status:"sent",title:"Q4 Office Supplies Order",description:"Quarterly office supplies procurement",items:[{productId:1,sku:"PROD-001",name:"Office Chair - Executive",quantity:50,unitPrice:299.99,discount:10,tax:0,total:13499.55},{productId:2,sku:"PROD-002",name:"Standing Desk",quantity:25,unitPrice:599.99,discount:15,tax:0,total:12749.79}],subtotal:26249.34,discountAmount:3281.17,discountPercent:12.5,taxAmount:1837.45,shippingAmount:500,total:25305.62,currency:"USD",paymentTerms:"Net 30",validUntil:"2024-12-31",salesRepId:1,salesRepName:"Sarah Johnson",viewCount:5,sentAt:"2024-10-15T10:00:00Z",viewedAt:"2024-10-16T09:30:00Z",createdAt:"2024-10-14T00:00:00Z",updatedAt:"2024-10-16T09:30:00Z"},{id:2,quoteNumber:"QT-2024-002",type:"rfq",companyId:2,companyName:"TechStart Inc",contactName:"Jane Doe",contactEmail:"jane.doe@techstart.com",contactPhone:"+1-555-0200",status:"accepted",title:"Server Hardware Upgrade",description:"Data center infrastructure upgrade",items:[{productId:3,sku:"SERV-001",name:"Rack Server - 2U",quantity:10,unitPrice:4999.99,discount:0,tax:0,total:49999.9}],subtotal:49999.9,discountAmount:0,discountPercent:0,taxAmount:0,shippingAmount:1e3,total:50999.9,currency:"USD",paymentTerms:"Net 60",validUntil:"2024-11-30",salesRepId:1,salesRepName:"Sarah Johnson",convertedToOrderId:15,convertedAt:"2024-10-20T14:00:00Z",viewCount:8,sentAt:"2024-10-10T10:00:00Z",viewedAt:"2024-10-11T08:00:00Z",createdAt:"2024-10-09T00:00:00Z",updatedAt:"2024-10-20T14:00:00Z"}],i=3;async function d(e={}){await u(200);let t=[...r];if(e.status&&(t=t.filter(n=>n.status===e.status)),e.companyId&&(t=t.filter(n=>n.companyId===parseInt(e.companyId))),e.salesRepId&&(t=t.filter(n=>n.salesRepId===parseInt(e.salesRepId))),e.type&&(t=t.filter(n=>n.type===e.type)),e.search){const n=e.search.toLowerCase();t=t.filter(a=>a.quoteNumber.toLowerCase().includes(n)||a.companyName.toLowerCase().includes(n)||a.title.toLowerCase().includes(n))}return t.sort((n,a)=>new Date(a.createdAt)-new Date(n.createdAt)),t.map(n=>o.fromAPI(n))}async function c(e){await u(200);const t=r.find(n=>n.id===parseInt(e));return t?o.fromAPI(t):null}async function l(e){await u(200);const t=r.find(n=>n.quoteNumber===e);return t?o.fromAPI(t):null}async function f(e){await u(300);const t=new o(e);if(!t.quoteNumber){const s=new Date().getFullYear();t.quoteNumber=`QT-${s}-${String(i).padStart(3,"0")}`}t.calculateTotals();const n=t.validate();if(!n.isValid)throw new Error(`Validation failed: ${n.errors.join(", ")}`);const a={...t.toJSON(),id:i++,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(a),o.fromAPI(a)}async function p(e,t){await u(300);const n=r.findIndex(a=>a.id===parseInt(e));if(n===-1)throw new Error("Quote not found");if(r[n]={...r[n],...t,updatedAt:new Date().toISOString()},t.items){const a=o.fromAPI(r[n]);a.calculateTotals(),r[n]=a.toJSON()}return o.fromAPI(r[n])}async function m(e){await u(300);const t=r.findIndex(n=>n.id===parseInt(e));if(t===-1)throw new Error("Quote not found");return r.splice(t,1),!0}async function w(e){await u(300);const t=r.find(n=>n.id===parseInt(e));if(!t)throw new Error("Quote not found");return t.status="sent",t.sentAt=new Date().toISOString(),t.updatedAt=new Date().toISOString(),o.fromAPI(t)}async function I(e){await u(200);const t=r.find(n=>n.id===parseInt(e));if(!t)throw new Error("Quote not found");return t.status==="sent"&&(t.status="viewed"),t.viewedAt=new Date().toISOString(),t.viewCount=(t.viewCount||0)+1,t.updatedAt=new Date().toISOString(),o.fromAPI(t)}async function A(e){await u(300);const t=r.find(n=>n.id===parseInt(e));if(!t)throw new Error("Quote not found");return t.status="accepted",t.updatedAt=new Date().toISOString(),o.fromAPI(t)}async function h(e,t){await u(300);const n=r.find(a=>a.id===parseInt(e));if(!n)throw new Error("Quote not found");return n.status="rejected",n.rejectionReason=t,n.updatedAt=new Date().toISOString(),o.fromAPI(n)}async function S(e){await u(300);const t=r.find(a=>a.id===parseInt(e));if(!t)throw new Error("Quote not found");if(t.status!=="accepted")throw new Error("Quote must be accepted before conversion");const n=Math.floor(Math.random()*1e3);return t.status="converted",t.convertedToOrderId=n,t.convertedAt=new Date().toISOString(),t.updatedAt=new Date().toISOString(),{quote:o.fromAPI(t),orderId:n}}async function g(e){await u(300);const t=r.find(a=>a.id===parseInt(e));if(!t)throw new Error("Quote not found");const n={...t,id:i++,quoteNumber:`QT-${new Date().getFullYear()}-${String(i).padStart(3,"0")}`,status:"draft",sentAt:null,viewedAt:null,viewCount:0,convertedToOrderId:null,convertedAt:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return r.push(n),o.fromAPI(n)}async function y(){return await u(200),{total:r.length,draft:r.filter(e=>e.status==="draft").length,sent:r.filter(e=>e.status==="sent").length,accepted:r.filter(e=>e.status==="accepted").length,rejected:r.filter(e=>e.status==="rejected").length,converted:r.filter(e=>e.status==="converted").length,expired:r.filter(e=>o.fromAPI(e).isExpired).length,totalValue:r.reduce((e,t)=>e+t.total,0),averageValue:r.length>0?r.reduce((e,t)=>e+t.total,0)/r.length:0,conversionRate:r.filter(e=>e.status==="sent").length>0?r.filter(e=>e.status==="converted").length/r.filter(e=>e.status==="sent").length*100:0}}const q={getQuotes:d,getQuoteById:c,getQuoteByNumber:l,createQuote:f,updateQuote:p,deleteQuote:m,sendQuote:w,markQuoteAsViewed:I,acceptQuote:A,rejectQuote:h,convertQuoteToOrder:S,duplicateQuote:g,getQuoteStats:y};export{A as acceptQuote,S as convertQuoteToOrder,f as createQuote,q as default,m as deleteQuote,g as duplicateQuote,c as getQuoteById,l as getQuoteByNumber,y as getQuoteStats,d as getQuotes,I as markQuoteAsViewed,h as rejectQuote,w as sendQuote,p as updateQuote};
