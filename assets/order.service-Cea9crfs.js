import{P as l}from"./index-D7HSGHDh.js";class a{constructor(t={}){this.id=t.id||null,this.orderNumber=t.orderNumber||"",this.customerId=t.customerId||null,this.customerEmail=t.customerEmail||"",this.items=t.items||[],this.subtotal=t.subtotal||0,this.tax=t.tax||0,this.taxRate=t.taxRate||0,this.shipping=t.shipping||0,this.discount=t.discount||0,this.discountCode=t.discountCode||"",this.total=t.total||0,this.currency=t.currency||"USD",this.shippingAddress=t.shippingAddress||{firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",state:"",zipCode:"",country:"",phone:""},this.billingAddress=t.billingAddress||{firstName:"",lastName:"",company:"",address1:"",address2:"",city:"",state:"",zipCode:"",country:"",phone:""},this.billingSameAsShipping=t.billingSameAsShipping!==void 0?t.billingSameAsShipping:!0,this.paymentMethod=t.paymentMethod||"",this.paymentStatus=t.paymentStatus||"pending",this.transactionId=t.transactionId||"",this.paymentDate=t.paymentDate||null,this.fulfillmentStatus=t.fulfillmentStatus||"unfulfilled",this.shippingMethod=t.shippingMethod||"",this.trackingNumber=t.trackingNumber||"",this.trackingUrl=t.trackingUrl||"",this.carrier=t.carrier||"",this.shippedDate=t.shippedDate||null,this.deliveredDate=t.deliveredDate||null,this.estimatedDelivery=t.estimatedDelivery||null,this.status=t.status||"pending",this.notes=t.notes||"",this.customerNotes=t.customerNotes||"",this.tags=t.tags||[],this.createdAt=t.createdAt||new Date().toISOString(),this.updatedAt=t.updatedAt||new Date().toISOString(),this.completedAt=t.completedAt||null,this.cancelledAt=t.cancelledAt||null}validate(){const t=[];(!this.customerEmail||this.customerEmail.trim()==="")&&t.push("Customer email is required"),(!this.items||this.items.length===0)&&t.push("Order must have at least one item"),this.total<=0&&t.push("Order total must be greater than 0");const e=this.shippingAddress;return(!e.firstName||!e.lastName||!e.address1||!e.city||!e.zipCode||!e.country)&&t.push("Shipping address is incomplete"),{isValid:t.length===0,errors:t}}calculateTotals(){return this.subtotal=this.items.reduce((t,e)=>t+e.price*e.quantity,0),this.tax=this.subtotal*this.taxRate/100,this.total=this.subtotal+this.tax+this.shipping-this.discount,this.items.forEach(t=>{t.total=t.price*t.quantity}),{subtotal:this.subtotal,tax:this.tax,shipping:this.shipping,discount:this.discount,total:this.total}}getItemCount(){return this.items.reduce((t,e)=>t+e.quantity,0)}canCancel(){return["pending","processing"].includes(this.status)&&this.paymentStatus!=="refunded"}canRefund(){return this.paymentStatus==="paid"&&!["cancelled","refunded"].includes(this.status)}isFulfilled(){return this.fulfillmentStatus==="fulfilled"}isPaid(){return this.paymentStatus==="paid"}generateOrderNumber(){const t=new Date,e=t.getFullYear().toString().substr(-2),r=String(t.getMonth()+1).padStart(2,"0"),s=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return this.orderNumber=`ORD-${e}${r}-${s}`,this.orderNumber}toJSON(){return{id:this.id,orderNumber:this.orderNumber,customerId:this.customerId,customerEmail:this.customerEmail,items:this.items,subtotal:this.subtotal,tax:this.tax,taxRate:this.taxRate,shipping:this.shipping,discount:this.discount,discountCode:this.discountCode,total:this.total,currency:this.currency,shippingAddress:this.shippingAddress,billingAddress:this.billingAddress,billingSameAsShipping:this.billingSameAsShipping,paymentMethod:this.paymentMethod,paymentStatus:this.paymentStatus,transactionId:this.transactionId,paymentDate:this.paymentDate,fulfillmentStatus:this.fulfillmentStatus,shippingMethod:this.shippingMethod,trackingNumber:this.trackingNumber,trackingUrl:this.trackingUrl,carrier:this.carrier,shippedDate:this.shippedDate,deliveredDate:this.deliveredDate,estimatedDelivery:this.estimatedDelivery,status:this.status,notes:this.notes,customerNotes:this.customerNotes,tags:this.tags,createdAt:this.createdAt,updatedAt:this.updatedAt,completedAt:this.completedAt,cancelledAt:this.cancelledAt}}static fromAPI(t){return new a(t)}}let d=[{id:1,orderNumber:"ORD-2411-0001",customerId:1,customerEmail:"john.doe@example.com",items:[{productId:1,name:"Professional Laptop",sku:"LAPTOP-001",quantity:1,price:1299.99,total:1299.99}],subtotal:1299.99,tax:130,taxRate:10,shipping:25,discount:0,total:1454.99,status:"delivered",paymentStatus:"paid",fulfillmentStatus:"fulfilled",createdAt:"2024-11-01T10:00:00Z"}],m=2;async function c(i={}){await l(300);let t=[...d];if(i.search){const r=i.search.toLowerCase();t=t.filter(s=>s.orderNumber.toLowerCase().includes(r)||s.customerEmail.toLowerCase().includes(r))}i.customerId&&(t=t.filter(r=>r.customerId===i.customerId)),i.status&&(t=t.filter(r=>r.status===i.status)),i.paymentStatus&&(t=t.filter(r=>r.paymentStatus===i.paymentStatus)),i.fulfillmentStatus&&(t=t.filter(r=>r.fulfillmentStatus===i.fulfillmentStatus)),i.startDate&&(t=t.filter(r=>new Date(r.createdAt)>=new Date(i.startDate))),i.endDate&&(t=t.filter(r=>new Date(r.createdAt)<=new Date(i.endDate))),i.sortBy?t.sort((r,s)=>{let u=r[i.sortBy],o=s[i.sortBy];return i.sortOrder==="desc"?u<o?1:u>o?-1:0:u>o?1:u<o?-1:0}):t.sort((r,s)=>new Date(s.createdAt)-new Date(r.createdAt));const e=t.length;if(i.page&&i.pageSize){const r=(i.page-1)*i.pageSize,s=r+i.pageSize;t=t.slice(r,s)}return{data:t.map(r=>a.fromAPI(r)),total:e,page:i.page||1,pageSize:i.pageSize||e,totalPages:i.pageSize?Math.ceil(e/i.pageSize):1}}async function f(i){await l(200);const t=d.find(e=>e.id===parseInt(i));return t?a.fromAPI(t):null}async function p(i){await l(200);const t=d.find(e=>e.orderNumber===i);return t?a.fromAPI(t):null}async function g(i){await l(300);const t=new a(i),e=t.validate();if(!e.isValid)throw new Error(`Validation failed: ${e.errors.join(", ")}`);t.orderNumber||t.generateOrderNumber(),t.calculateTotals();const r={...t.toJSON(),id:m++,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return d.push(r),a.fromAPI(r)}async function S(i,t){await l(300);const e=d.findIndex(r=>r.id===parseInt(i));if(e===-1)throw new Error("Order not found");return d[e]={...d[e],...t,updatedAt:new Date().toISOString()},a.fromAPI(d[e])}async function w(i,t){await l(200);const e=d.find(r=>r.id===parseInt(i));if(!e)throw new Error("Order not found");return e.status=t,e.updatedAt=new Date().toISOString(),t==="delivered"?(e.completedAt=new Date().toISOString(),e.deliveredDate=new Date().toISOString()):t==="cancelled"&&(e.cancelledAt=new Date().toISOString()),a.fromAPI(e)}async function y(i,t,e=null){await l(200);const r=d.find(s=>s.id===parseInt(i));if(!r)throw new Error("Order not found");return r.paymentStatus=t,e&&(r.transactionId=e),t==="paid"&&(r.paymentDate=new Date().toISOString()),r.updatedAt=new Date().toISOString(),a.fromAPI(r)}async function A(i,t,e={}){await l(200);const r=d.find(s=>s.id===parseInt(i));if(!r)throw new Error("Order not found");return r.fulfillmentStatus=t,e.trackingNumber&&(r.trackingNumber=e.trackingNumber),e.carrier&&(r.carrier=e.carrier),e.trackingUrl&&(r.trackingUrl=e.trackingUrl),t==="fulfilled"&&(r.shippedDate=new Date().toISOString()),r.updatedAt=new Date().toISOString(),a.fromAPI(r)}async function D(i,t=""){await l(300);const e=d.find(s=>s.id===parseInt(i));if(!e)throw new Error("Order not found");if(!a.fromAPI(e).canCancel())throw new Error("Order cannot be cancelled");return e.status="cancelled",e.cancelledAt=new Date().toISOString(),e.notes=(e.notes?e.notes+`
`:"")+`Cancelled: ${t}`,e.updatedAt=new Date().toISOString(),a.fromAPI(e)}async function O(i,t=""){await l(300);const e=d.find(s=>s.id===parseInt(i));if(!e)throw new Error("Order not found");if(!a.fromAPI(e).canRefund())throw new Error("Order cannot be refunded");return e.status="refunded",e.paymentStatus="refunded",e.notes=(e.notes?e.notes+`
`:"")+`Refunded: ${t}`,e.updatedAt=new Date().toISOString(),a.fromAPI(e)}async function I(i,t={}){return c({...t,customerId:i})}async function b(i=null,t=null){await l(200);let e=[...d];i&&(e=e.filter(n=>new Date(n.createdAt)>=new Date(i))),t&&(e=e.filter(n=>new Date(n.createdAt)<=new Date(t)));const r=e.length,s=e.reduce((n,h)=>n+h.total,0),u=r>0?s/r:0,o={pending:e.filter(n=>n.status==="pending").length,processing:e.filter(n=>n.status==="processing").length,shipped:e.filter(n=>n.status==="shipped").length,delivered:e.filter(n=>n.status==="delivered").length,cancelled:e.filter(n=>n.status==="cancelled").length,refunded:e.filter(n=>n.status==="refunded").length};return{totalOrders:r,totalRevenue:s,averageOrderValue:u,ordersByStatus:o}}const v={getOrders:c,getOrderById:f,getOrderByNumber:p,createOrder:g,updateOrder:S,updateOrderStatus:w,updatePaymentStatus:y,updateFulfillmentStatus:A,cancelOrder:D,refundOrder:O,getOrdersByCustomer:I,getOrderStats:b};export{D as cancelOrder,g as createOrder,v as default,f as getOrderById,p as getOrderByNumber,b as getOrderStats,c as getOrders,I as getOrdersByCustomer,O as refundOrder,A as updateFulfillmentStatus,S as updateOrder,w as updateOrderStatus,y as updatePaymentStatus};
